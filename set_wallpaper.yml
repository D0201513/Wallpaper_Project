---
- name: ğŸªŸ Set Windows Wallpaper via Registry
  hosts: windows
  gather_facts: false

  tasks:
    - name: ğŸ“„ Copy wallpaper image to Windows
      win_copy:
        src: wallpaper.png
        dest: C:\Users\Public\Pictures\wallpaper.png

    - name: ğŸ–¼ï¸ Set wallpaper path in registry
      win_regedit:
        path: HKCU:\Control Panel\Desktop
        name: Wallpaper
        data: C:\Users\Public\Pictures\wallpaper.png
        type: string

    - name: ğŸ§­ Set wallpaper style (Fill)
      win_regedit:
        path: HKCU:\Control Panel\Desktop
        name: WallpaperStyle
        data: "10"
        type: string

    - name: ğŸ”„ Apply wallpaper using RUNDLL32
      win_command: RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters 1, True
